# WEB_TIMEOUT_ERROR (web-004)

## Error Description

This error occurs when Cursor Utils experiences a timeout while waiting for a response from the Perplexity API during a web command. The request was initiated successfully, but the API took too long to respond, causing the connection to time out.

## Example Error

```
Ã— ERROR: Timed out waiting for response from Perplexity API
  Code: web-004
  
  Causes:
  - Slow network connection
  - Perplexity API service is experiencing high load
  - Complex query requiring extended processing time
  - Network interruption during response
  
  Suggestion: Try a simpler query or try again later
  
  For more information: https://github.com/gweidart/cursor-utils/errors/web-004.md
```

## Common Causes

1. **Slow Network**: Your internet connection is slow or unstable.
2. **High API Load**: The Perplexity API is experiencing high load or performance issues.
3. **Complex Query**: Your query is particularly complex, requiring extensive processing time.
4. **Network Interruption**: Your network connection was interrupted during the API response.
5. **Default Timeout Too Short**: The configured timeout value is too short for your network conditions.
6. **Server-Side Processing Delay**: The server is taking longer than expected to process the request.

## Solutions

### Check your internet connection speed

Verify that your internet connection is fast and stable:

```bash
# Using speedtest-cli (if installed)
speedtest-cli

# Or visit speedtest.net in a browser
```

### Increase the timeout value

Set a longer timeout for your request:

```bash
cursor-utils web "your query" --timeout 60
```

This sets the timeout to 60 seconds (default is usually 30 seconds).

### Simplify your query

Complex queries may take longer to process. Try simplifying your query:

- Break long, complex questions into simpler ones
- Remove unnecessary details
- Focus on a specific aspect of your question

### Try retry options

Use retry options to automatically retry failed requests:

```bash
cursor-utils web "your query" --retries 3 --retry-delay 5
```

This attempts the request up to 3 times with a 5-second delay between retries.

### Check API status

Check if the Perplexity API is experiencing issues:

- Visit [Perplexity Status Page](https://status.perplexity.ai)
- Check for announcements on the [Perplexity website](https://www.perplexity.ai)

### Use a different network

If possible, try using a different network connection:
- Switch from Wi-Fi to wired connection
- Try a mobile hotspot
- Use a different Wi-Fi network

## Related Commands

- `cursor-utils web --help` - Show help for the web command
- `cursor-utils config show` - Display current configuration
- `cursor-utils test connection` - Test API connectivity

## Related Error Codes

- [WEB_API_ERROR (web-001)](web-001.md) - Error with Perplexity API
- [WEB_CONNECTION_ERROR (web-003)](web-003.md) - Connection error during web command
- [WEB_STREAM_ERROR (web-005)](web-005.md) - Error with streaming response

## Advanced Troubleshooting

### Configure persistent timeout settings

Set a default timeout value in your configuration:

```bash
cursor-utils config set web.timeout 60
```

This sets the default timeout to 60 seconds for all web commands.

### Check network quality

Network quality issues can cause timeouts:

```bash
# Check for packet loss
ping -c 100 api.perplexity.ai | grep "packet loss"

# Check for latency
ping -c 10 api.perplexity.ai | grep "avg"
```

### Debug the request

Run the command with debug logging to see detailed request information:

```bash
cursor-utils web "your query" --debug
```

### Check for network congestion

Network congestion can cause timeouts:

```bash
# Linux/macOS
mtr api.perplexity.ai

# Windows (if pathping is available)
pathping api.perplexity.ai
```

## Optimizing for Reliable Performance

### Use a wired connection

Wired connections are generally more stable than wireless connections:
- Connect your computer directly to your router with an Ethernet cable
- This can reduce latency and packet loss

### Optimize for slower connections

If you're on a slower connection:

```bash
# Use concise mode for shorter responses
cursor-utils web "your query" --mode concise

# Use a simpler model
cursor-utils web "your query" --model sonar
```

### Schedule demanding queries

For complex queries or during peak usage times:
- Run queries during off-peak hours
- Use the `--save-to` option to save results for later viewing
  ```bash
  cursor-utils web "complex query" --save-to results.md
  ```

## Common Timeout Scenarios and Solutions

| Scenario | Symptoms | Solution |
|----------|----------|----------|
| Large query | Timeout with complex, multi-part questions | Break into smaller, focused queries |
| Peak usage | Timeouts during business hours | Try during off-peak hours |
| Slow connection | Consistent timeouts with any query | Increase timeout, use simpler models |
| Intermittent timeouts | Some queries work, others time out | Use retry options, check for network issues |
| Geography-based | Timeouts from certain locations | Consider using a VPN or proxy closer to API servers |

## Still Having Issues?

If you've tried the solutions above and still encounter the error, please:

1. Run with maximum debug information:
   ```bash
   cursor-utils web "test query" --debug --timeout 120
   ```

2. Check the logs:
   ```bash
   cat ~/.cursor-utils/logs/cursor-utils.log
   ```

3. Try with a minimal test query:
   ```bash
   cursor-utils web "Hello world" --timeout 120
   ```

4. If the issue persists, please [submit a bug report](https://github.com/gweidart/cursor-utils/issues) with:
   - The complete error message
   - Your query (or a simplified version of it)
   - Network diagnostics (ping, traceroute, speedtest results)
   - The timeout values you've tried
   - Your operating system and network configuration 