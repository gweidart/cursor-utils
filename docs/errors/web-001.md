# WEB_API_ERROR (web-001)

## Error Description

This error occurs when Cursor Utils encounters an issue with the Perplexity API while executing a web command. The error typically indicates that there was a problem with the API request, response, or authentication.

## Example Error

```
Ã— ERROR: Failed to complete web search request
  Code: web-001
  
  Causes:
  - Invalid or missing Perplexity API key
  - Perplexity API service may be unavailable
  - Network connectivity issues
  - Rate limit exceeded
  
  Suggestion: Check your API key and internet connection, then try again
  
  For more information: https://gweidart.github.io/cursor-utils/errors/web-001.md
```

## Common Causes

1. **Invalid API Key**: Your Perplexity API key is incorrect, expired, or not properly configured.
2. **Missing API Key**: You haven't set up a Perplexity API key.
3. **API Service Issues**: The Perplexity API service might be experiencing downtime or issues.
4. **Network Problems**: There might be network connectivity issues between your system and the Perplexity API servers.
5. **Rate Limiting**: You might have exceeded the rate limits for your Perplexity API key.
6. **Request Format**: The request format might be invalid or contain unsupported parameters.

## Solutions

### Check your API key

Verify that your Perplexity API key is correctly set up:

```bash
cursor-utils config api_keys
```

If your API key is not set or needs to be updated, you can set it with:

```bash
cursor-utils config api_keys --type PERPLEXITY
```

### Check API key in environment

Ensure the API key is correctly set in your environment:

```bash
# Linux/macOS
grep PERPLEXITY_API_KEY ~/.env
```

```bash
# Windows (PowerShell)
Get-Content ~/.env | Select-String PERPLEXITY_API_KEY
```

### Test your internet connection

Verify that you have a working internet connection:

```bash
ping api.perplexity.ai
```

### Check API status

Visit the [Perplexity Status Page](https://status.perplexity.ai) to see if there are any reported service issues.

### Reduce request complexity

If you're hitting rate limits, try:
- Simplifying your query
- Breaking complex requests into smaller parts
- Adding delays between requests

### Run in debug mode

Execute the command with the debug flag to get more detailed error information:

```bash
cursor-utils web "your query" --debug
```

## Related Commands

- `cursor-utils web --help` - Show help for the web command
- `cursor-utils config api_keys` - Manage API keys
- `cursor-utils config show` - Display current configuration

## Related Error Codes

- [WEB_CONFIG_ERROR (web-002)](web-002.md) - Error with web command configuration
- [WEB_CONNECTION_ERROR (web-003)](web-003.md) - Connection error during web command
- [WEB_TIMEOUT_ERROR (web-004)](web-004.md) - Timeout during web command
- [INVALID_API_KEY (config-001)](config-001.md) - Invalid API key

## Advanced Troubleshooting

### Check request and response details

When running in debug mode, you can see the full request and response details in the logs:

```bash
cat ~/.cursor-utils/logs/cursor-utils.log
```

Look for entries with "WEB_API_ERROR" or related to the Perplexity API.

### Check for JSON parsing errors

If the API response is valid but cannot be parsed, there might be an issue with JSON parsing. Look for error messages like "JSON decode error" in the logs.

### API Parameters

Ensure you're using supported parameters for the Perplexity API:

- **Models**: sonar, sonar-pro, sonar-reasoning, sonar-pro-reasoning
- **Modes**: copilot, concise
- **Search focuses**: internet, scholar, writing, wolfram, youtube, reddit

You can specify these parameters in your configuration file or via command-line options.

## Still Having Issues?

If you've tried the solutions above and still encounter the error, please:

1. Update Cursor Utils to the latest version:
   ```bash
   cursor-utils update
   ```

2. Check if your issue is already reported in the [GitHub Issues](https://github.com/gweidart/cursor-utils/issues).

3. If not, submit a new bug report with:
   - The exact command you were trying to run
   - The complete error message
   - Your Cursor Utils version (`cursor-utils --version`)
   - Debug logs (`~/.cursor-utils/logs/cursor-utils.log`) with sensitive information redacted
   - Your operating system and version 